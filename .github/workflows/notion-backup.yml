‚óè name: Notion Backup

  on:
    schedule:
      - cron: '0 0 * * *'
    workflow_dispatch:

  jobs:
    backup:
      runs-on: ubuntu-latest

      steps:
        - name: Checkout repository
          uses: actions/checkout@v4

        - name: Notion Backup to Markdown
          uses: thecommoncoder/notion-backup@v2
          with:
            notion-token: ${{ secrets.NOTION_TOKEN }}
            notion-page-id: ${{ secrets.NOTION_PAGE_ID }}
            output-dir: './backup'

        - name: Commit and push changes
          run: |
            git config --local user.email "github-actions[bot]@users.noreply.github.com"
            git config --local user.name "github-actions[bot]"
            git add ./backup
            git diff --staged --quiet || git commit -m "Auto backup from Notion - $(date '+%Y-%m-%d %H:%M:%S')"
            git push
